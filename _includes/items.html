<template x-for="(item, itemidx) in self.items" :key="item.key">
    <div class="block">
        <div class="is-flex is-flex-direction-row">
            <h3 class="is-size-4" x-text = "'#' + (itemidx + 1)"></h3>
            <hr class="is-flex-grow-1 mx-2">
            <div class="field buttons is-right" x-show="self.items.length > 1">
                <button class="button is small is-danger-light" @click="delItem(self, itemidx)">
                    <span class="icon is-small">{% include icon.html i = 'xmark' %}</span>
                    <span>Delete</span>
                </button>
            </div>
        </div>
    <section class="block">
        <div class="field">
            <label class="label">
                {{ include.vars.item-name }}
            </label>
            <div class="control">
                <input
                    class="input"
                    type="text"
                    name="{{ include.vars.item-name }}"
                    placeholder="{{ include.vars.item-name }}"
                    x-model="item.title"
                >
            </div>
        </div>

        {% if include.vars.org %}
        <div class="field">
            <label class="label">
                {{ include.vars.org }}
            </label>
            <div class="control">
                <input
                    class="input"
                    type="text"
                    name="{{ include.vars.org }}"
                    placeholder="{{ include.vars.org }}"
                    x-model="item.org"
                >
            </div>
        </div>
        {% endif %}

        {% if include.vars.location %}
        <div class="field">
            <label class="label">
                {{ include.vars.location }}
            </label>
            <div class="control">
                <input
                    class="input"
                    type="text"
                    name="{{ include.vars.location }}"
                    placeholder="{{ include.vars.location }}"
                    x-model="item.loc"
                >
            </div>
        </div>
        {% endif %}


        {% if include.vars.dates %}
            <div class="columns">
                {% if include.vars.dates.start %}
                    <div class="column">
                        <div class="field">
                            <label class="label">
                                {{ include.vars.dates.start }}
                            </label>
                            <div class="control">
                                <input
                                    class="input"
                                    type="month"
                                    name="{{ include.vars.dates.start }}"
                                    x-model="item.dates.start"
                                >
                            </div>
                        </div>
                    </div>
                {% endif %}
                {% if include.vars.dates.end %}
                    <div class="column">
                        <div class="field">
                            <label class="label">
                                {{ include.vars.dates.end }}
                            </label>
                            <div class="control">
                                <input
                                    class="input"
                                    type="month"
                                    name="{{ include.vars.dates.end }}"
                                    x-model="item.dates.end"
                                    {% if include.vars.dates.current-blocks %}:disabled="item.dates.current"{% endif %}
                                >
                            </div>
                            {% if include.vars.dates.current %}
                            <label class="checkbox is-small">
                                <input
                                    type="checkbox"
                                    name="current"
                                    x-model="item.dates.current"
                                >
                                {{ include.vars.dates.current }}
                            </label>
                            {% endif %}
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endif %}

        {% if include.vars.subitems %}
        <div class="field" x-data="{ editing: false }">
            <div class="block level">
                <div class="level-left">
                    <div class="level-item">
                        <h4 class="title is-6" x-show="!editing" x-text="self.subtitle"></h3>
                        <div class="control" x-show="editing">
                            <input class="input is-small" x-model="self.subtitle">
                        </div>
                    </div>
                    <div class="level-item">
                        <button class="button is-small is-primary-inverted" x-show="!editing" @click="editing=true">
                            <span class="icon is-small">{% include icon.html i='pen' %}</span>
                            <span>Edit Subtitle</span>
                        </button>
                        <button class="button is-small is-primary" x-show="editing" @click="editing=false">
                            <span class="icon is-small">{% include icon.html i='check' %}</span>
                            <span>Save</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="field">
                <div class="control">
                    <div
                        class="textarea bulletbox"
                        rows
                        x-bind="listable"
                        x-model="item.subitems"
                    >
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

    </section>
    </div>
</template>

<div class="block field buttons">
    <button class="block button is-link-inverted" @click="addFullItem(self)">
        <span class="icon is-small">{% include icon.html i='plus' %}</span>
        <span>Add more</span>
    </button>
</div>

